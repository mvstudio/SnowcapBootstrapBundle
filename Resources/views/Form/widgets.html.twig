{% extends 'form_div_layout.html.twig' %}

{% block field_row %}
{% if attr is not defined %}{% set attr = {} %}{% endif %}
{% spaceless %}
<div class="control-group{% if errors|length > 0 %} error{% endif %}">
    {{ form_label(form, null, {'attr': {'class': 'control-label'}}) }}
    <div class="controls">
        {{ form_widget(form, {'attr': attr}) }}
        {{ block('field_help') }}
        {{ form_errors(form) }}
    </div>
</div>
{% endspaceless %}
{% endblock field_row %}

{% block repeated_row %}
    {% spaceless %}
        <div class="control-group{% if errors|length > 0 %} error{% endif %}">
            {% for child in form %}
                {{ form_row(child) }}
            {% endfor %}
            <div class="controls">
                {{ block('field_help') }}
                {{ form_errors(form) }}
            </div>
        </div>
    {% endspaceless %}
{% endblock repeated_row %}

{% block field_errors %}
    {% spaceless %}
        {% if errors|length > 0 %}
            {% for error in errors %}
                <p class="help-block">{{ error.messageTemplate|trans(error.messageParameters, 'validators') }}</p>
            {% endfor %}
        {% endif %}
    {% endspaceless %}
{% endblock field_errors %}

{% block email_widget %}
    {% spaceless %}
        {% set type = type|default('email') %}
        <div class="input-prepend">
            <span class="add-on">@</span>{{ block('field_widget') }}
        </div>
    {% endspaceless %}
{% endblock email_widget %}

{% block checkbox_row %}
    {% spaceless %}
    <div class="control-group{% if errors|length > 0 %} error{% endif %} {{ form_row_classes(types) }}">
        {% set attr = attr|merge({'class': attr.class|default('') ~ ' checkbox' }) %}
        {% if required %}
            {% set attr = attr|merge({'class': attr.class|default('') ~ ' required'}) %}
        {% endif %}
        <div class="controls">
            {{ form_label(form, label|default(null)) }}
            {{ block('field_help') }}
            {{ form_errors(form) }}
        </div>
    </div>
    {% endspaceless %}
{% endblock %}

{% block checkbox_label %}
    <label class="checkbox">
        {{ form_widget(form) }}
        {{ label|trans|raw }}
    </label>
{% endblock %}

{% block choice_widget %}
    {% spaceless %}
        {% if expanded %}
            {% set attr = attr|merge({'class': attr.class|default('') ~ ' input-container'}) %}
            <div {{ block('widget_container_attributes') }}>
                <div class="input-container-inner">
                    {% set label_class = multiple ? 'checkbox' : 'radio' %}
                    {% for child in form %}
                        <label class="{{ label_class }}">
                            {{ form_widget(child) }}
                            {{ child.get('label')|trans|raw }}
                        </label>
                    {% endfor %}
                </div>
            </div>
        {% else %}
            {{ parent() }}
        {% endif %}
    {% endspaceless %}
{% endblock choice_widget %}

{% block field_help %}
    {% if help_block is defined %}
        <p class="help-block">{{ help_block }}</p>
    {% elseif help_inline is defined %}
        <span class="help-inline">{{ help_inline }}</span>
    {% endif %}
{% endblock field_help %}

{% block snowcap_core_image_widget %}
    {% if file_url is not null %}
        <img src="{{ asset(file_url) }}"/><br/>
    {% endif %}
    {{ form_widget(form.file) }}
    {% if file_url is not null %}
        <label class="checkbox">
            {{ form_widget(form.delete) }}
            {{ form.delete.vars['label']|trans|raw }}
        </label>
    {% endif %}
{% endblock %}

{% block snowcap_core_video_widget %}
    {% if video_id is not null and form.parent.vars.value is not empty %}
    {% set video_id_value = attribute(form.parent.vars.value, video_id) %}
        {% if provider == 'youtube' %}
            <iframe width="420" height="315" src="http://www.youtube.com/embed/{{ video_id_value }}" frameborder="0" allowfullscreen></iframe>
            <br/>
        {% endif %}
    {% endif %}
    {{ block('field_widget') }}
{% endblock %}

{% block snowcap_core_file_widget %}
    {{ block('field_widget') }}
    {% if web_path is not null and form.parent.vars.value is not empty %}
        {% set url = attribute(form.parent.vars.value, web_path) %}
        {% if url is not null %}
            <a class="btn" href="/{{ url }}">Download file</a>
        {% endif %}
    {% endif %}
{% endblock %}